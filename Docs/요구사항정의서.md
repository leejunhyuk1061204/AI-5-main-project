# 요구사항정의서

> **버전**: v1.2
> **작성일**: 2026-01-10
> **프로젝트명**: 차량 예지 정비 시스템 (Project TBD)

---

## 1. 개요

### 1.1 프로젝트 정보

| 항목 | 내용 |
|:---|:---|
| **프로젝트명** | 차량 예지 정비 시스템 |
| **핵심 목표** | OBD-II 데이터와 AI를 결합한 초개인화 차량 예지 정비 및 통합 관리 솔루션 |
| **플랫폼** | 모바일 앱 (Android, iOS) + 웹 (미정) |

### 1.2 용어 정의

| 용어 | 정의 |
|:---|:---|
| OBD-II | 차량 자가진단 표준 인터페이스 |
| DTC | Diagnostic Trouble Code, 차량 고장 코드 |
| VIN | Vehicle Identification Number, 차대번호 |
| SoC | State of Charge, 배터리 충전 잔량 (전기차) |
| SoH | State of Health, 배터리 수명 상태 (전기차) |

---

## 2. 기능 요구사항 (MVP & Additional)

### 2.1 사용자 관리 (FR-USER)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-USER-001 | C | 회원가입 | 이메일/소셜 계정으로 회원가입 | 🔴 |
| FR-USER-002 | R | 로그인 | 이메일/소셜 로그인 및 세션 유지 | 🔴 |
| FR-USER-003 | R | 내 정보 조회 | 프로필 정보 조회 | 🔴 |
| FR-USER-004 | U | 내 정보 수정 | 닉네임, 알림 설정 변경 | 🟡 |
| FR-USER-005 | U | 비밀번호 변경 | 비밀번호 재설정 (bcrypt 단방향 해시 적용) | 🔴 |
| FR-USER-006 | D | 회원 탈퇴 | 개인정보 익명화 (데이터는 AI 학습용 보존) | 🟡 |
| FR-USER-007 | R | 로그아웃 | 세션 종료 | 🔴 |

### 2.2 차량 관리 (FR-CAR)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-CAR-001 | C | 차량 등록 | 차량번호 또는 VIN으로 차량 등록 (VIN 암호화 저장) | 🔴 |
| FR-CAR-002 | R | 차량 목록 조회 | 등록된 차량 목록 표시 | 🔴 |
| FR-CAR-003 | R | 차량 상세 조회 | 차량 기본정보, 제원 조회 (공공 API 연동) | 🔴 |
| FR-CAR-004 | U | 차량 정보 수정 | 별명, 메모 등 수정 | 🟡 |
| FR-CAR-005 | U | 대표 차량 설정 | 기본 표시 차량 지정 | 🟡 |
| FR-CAR-006 | D | 차량 삭제 | Soft Delete (deleted_at 필드 처리, 정비 이력 및 AI 학습 데이터 보존) | 🟡 |

### 2.3 OBD-II 연결 및 모니터링 (FR-OBD)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-OBD-001 | C | 블루투스 페어링 | ELM327 어댑터와 블루투스 페어링 및 연결 (PIN/MAC 바인딩) | 🔴 |
| FR-OBD-002 | R | 연결 상태 조회 | 현재 연결 상태 및 신호 강도 표시 | 🔴 |
| FR-OBD-003 | R | 실시간 데이터 스트리밍 | 1초 주기로 PID 수집 (내연기관 기준: RPM, 속도, 온도, 연료트림 등) | 🔴 |
| FR-OBD-004 | U | 자동 재연결 | 연결 해제 시 1초 간격으로 자동 재시도 로직 실행 | 🔴 |
| FR-OBD-005 | D | 연결 해제 | 블루투스 연결 명시적 종료 | 🔴 |

### 2.4 전기차/하이브리드 통합 지원 (FR-EV)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-EV-001 | R | 유종 자동 감지 및 PID 전환 | 차량 연결 시 유종(ICE/EV/HEV)을 감지하여 수집 PID 맵 자동 스위칭 | 🔴 |
| FR-EV-002 | R | EV 특화 데이터 수집 | 배터리 잔량(SoC), 수명(SoH), 셀 전압, 모터 온도 모니터링 | 🔴 |
| FR-EV-003 | R | EV 전용 리포트 | 배터리 잔량(SoC), 수명(SoH), 충전 상태(charging_status) 등 진단 리포트 표시 | 🔴 |

### 2.5 제조사 클라우드 연동 (FR-CLOUD)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-CLOUD-001 | C | 커넥티드 계정 연동 | Smartcar/High Mobility 등 제조사 커넥티드 서비스 OAuth 연동 | 🔴 |
| FR-CLOUD-002 | R | 데이터 주기적 동기화 | 누적 주행거리, SoC 등을 **비동기 큐**를 통해 제조사 API와 연동하여 업데이트 | 🔴 |
| FR-CLOUD-003 | C | 가상 차량 시뮬레이션 | 실제 차량 미연동 시 샌드박스 환경 가상 데이터 생성 및 연동 | 🔴 |

### 2.6 주행 데이터 관리 (FR-DRIVE)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-DRIVE-001 | C | 주행 데이터 로깅 | OBD/API 수집 데이터를 TimescaleDB(Hot) 및 Postgres(Warm)에 계층별 저장 | 🔴 |
| FR-DRIVE-002 | R | 주행 이력 조회 | 일/주/월별 주행 시간, 거리, 루트 등 기록 조회 | 🔴 |
| FR-DRIVE-003 | R | 운전 습관 분석 점수 | 급가속, 급제동, 과속 빈도를 분석하여 100점 만점 운전 점수 산출 | 🔴 |
| FR-DRIVE-004 | R | 주행 통계 리포트 | 대용량 주행 데이터를 **백그라운드 비동기 처리**로 가공하여 통계 리포트 제공 | 🟡 |
| FR-DRIVE-005 | D | 주행 이력 삭제 | 데이터 Soft Delete 및 AI 학습용 익명화 보존 | 🟢 |

### 2.7 AI 통합 진단 시스템 (FR-DIAG)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-DIAG-001 | C | DTC 스캔 및 저장 | SAE J2012 표준 고장 코드 읽기 및 이력 영구 저장 | 🔴 |
| FR-DIAG-002 | C | 멀티모달 융합 진단 요청 | DTC, 시동음, 사진, OBD 데이터를 결합한 진단 요청을 **비동기 큐(RabbitMQ)**로 전달 | 🔴 |
| FR-DIAG-003 | R | AI 종합 진단 리포트 | LLM/RAG 기반 분석 결과 리포트 제공 (진단 완료 후 상태 업데이트 및 알림) | 🔴 |
| FR-DIAG-004 | R | 대화형 증거 요청 | 진단 정보 부족 시 AI가 사용자에게 추가 사진/점검(미션)을 대화형으로 요청 | 🔴 |
| FR-DIAG-005 | R | 외부 지식 하이브리드 검색 | 내부 매뉴얼(RAG) + 외부 실시간 검색(Tavily) 통합 분석 | 🟡 |

### 2.8 AI 고장 예측 (FR-PREDICT)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-PREDICT-001 | C | 시계열 추세 분석 (배치) | LSTM-AutoEncoder/Prophet 모델로 주기적 데이터 추세 분석 (운전 패턴 분석을 통한 개인별 비운행 시간대 자동 실행) | 🔴 |
| FR-PREDICT-002 | R | 부품 수명 예지 | 배터리 방전, 연료 계통, 냉각 효율 저하 등 고장 징후 사전 예측 및 시점 안내 | 🔴 |
| FR-PREDICT-003 | R | 시연용 데이터 주입 | 시연을 위한 가상 고장 이력 데이터셋 주입(Injection) 기능 | 🔴 |

### 2.9 셀프 점검 - 시동음 (FR-SOUND)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-SOUND-001 | C | 시동음 녹음 및 저장 | 보닛 30cm 거리에서 녹음 및 WAV 원본 저장 | 🔴 |
| FR-SOUND-002 | R | AST 정밀 부위 분석 | Mel-Spectrogram + AST(Audio Spectrogram Transformer) 모델로 엔진 이음/벨트 소음 등 정밀 분류 | 🔴 |
| FR-SOUND-003 | R | 분석 이력 관리 | 과거 녹음 파일 및 분석 결과 히스토리 관리 | 🟡 |

### 2.10 셀프 점검 - 사진/이미지 (FR-PHOTO)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-PHOTO-001 | C | 차량 부위 촬영 및 저장 | 타이어, 계기판, 엔진룸 등 진단 필요 부위 촬영 및 저장 | 🔴 |
| FR-PHOTO-002 | R | 시각적 이상 분석 | YOLOv8-Large/OCR 기반 미세 마모, 파손, 누유, 계기판 수치 정밀 분석 | 🔴 |
| FR-PHOTO-003 | R | 분석 리포트 생성 | 시각 분석 결과와 OBD 데이터를 연계한 종합 리포트 생성 (FR-DIAG-002 연동) | 🟡 |

### 2.11 소모품 예측 및 차계부 (FR-PARTS)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-PARTS-001 | C | 정비 기록 등록 (차계부) | 소모품 교체 및 정비 내역 수동 입력/수정 (교체 주기 리셋 트리거) | 🔴 |
| FR-PARTS-002 | R | 잔존 수명 예측 (AI) | XGBoost 모델: 주행거리 + 운전 가혹도(Score) 반영한 개인화 수명 예측 | 🔴 |
| FR-PARTS-003 | R | Cold Start 대응 | 데이터 부족 시 표준 주기 및 공공 통계 기반 교체 시점 안내 | 🔴 |
| FR-PARTS-004 | R | 소모품 리스트 조회 | 엔진오일, 타이어, 브레이크 등 주요 소모품 상태 목록 조회 | 🔴 |

### 2.12 실시간 이상 감지 (FR-ANOMALY)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-ANOMALY-001 | C | 하이브리드 이상 감지 | Rule-Based(전압 급락 등) + LSTM-AutoEncoder(개인화 패턴 재구성 오차) 실시간 감지 | 🔴 |
| FR-ANOMALY-002 | R | 긴급 알림 (Push) | 안전 임계치 초과 시 **비동기 큐(FCM)**를 통해 즉각적인 경고 알림 발송 | 🔴 |
| FR-ANOMALY-003 | R | 이상 원인 분석 리포트 | 감지된 이상 패턴에 대한 AI의 상세 원인 분석 및 조치 권고 제공 | 🟡 |

### 2.13 리콜 정보 및 알림 (FR-RECALL)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-RECALL-001 | R | 리콜 정보 조회 | VIN 기반 국토부 리콜 상세 정보(대상 부품, 조치 방법) 조회 | 🔴 |
| FR-RECALL-002 | R | 정기검사 만료일 지원 | 한국교통안전공단 데이터 연동 검사 유효기간 및 만료 알림 | 🟡 |
| FR-RECALL-003 | R | 알림 히스토리 관리 | 발송된 모든 알림 내역 조회 및 확인 처리 | 🟡 |

### 2.14 지능형 개인화 서비스 (FR-AI-PERS)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-PERS-001 | R | 개인화 인사이트 | 주행 패턴 분석 기반 연비 향상 팁, 안전 운전 가이드 제공 | 🟡 |
| FR-PERS-002 | R | 맞춤형 상품 추천 | (Extension) 소모품 교체 시기 도래 시 적합한 규격 제품/정비 프로모션 추천 | 🟢 |

### 2.15 알림 설정 (FR-NOTI)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-NOTI-001 | U | 알림 수신 설정 | 소모품, 이상감지, 리콜, 마케팅 등 알림 카테고리별 ON/OFF | 🟡 |

---

## 3. 로드맵 요구사항 (확장 기능)

### 3.1 정비소 관리 및 예약 (FR-SHOP/BOOK)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-SHOP-001 | C | 정비소 찾기 및 매칭 | 위치 및 고장 유형(수입차/타이어 등) 기반 최적 정비소 추천 | 🟢 |
| FR-BOOK-001 | C | 실시간 정비 예약 | 앱 내에서 정비소 예약 및 진단 데이터(DTC/소리) 사전 전송 | 🟢 |

### 3.2 사고 견적 및 가치 산정 (FR-VALUE)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-ESTIMATE-001 | R | AI 사고 견적 (VLM) | 파손 사진 분석을 통한 예상 수리비 및 공임 산출 | 🟢 |
| FR-VALUE-001 | R | 중고차 상태 가치 평가 | 엔진 건강 상태 및 정비 이력을 반영한 실질적 차량 가치 산정 | 🟢 |

### 3.3 유지보수 자동화 (FR-AUTO)

| ID | 구분 | 요구사항 | 설명 | 우선순위 |
|:---|:---:|:---|:---|:---:|
| FR-AUTO-001 | C | 정비 영수증 OCR | 종이 영수증/명세서 촬영 시 정비 내역 자동 디지털 변환 및 차계부 입력 | 🟢 |
| FR-AUTO-002 | R | 블록체인 차량 인증 | 주요 정비 및 무사고 이력의 위변조 방지 인증서 생성 (NFT 연동 고려) | 🟢 |

---

## 4. 비기능 요구사항

### 4.1 성능 (NFR-PERF)

| ID | 요구사항 | 수용 기준 | 우선순위 |
|:---|:---|:---|:---:|
| NFR-PERF-001 | 응답 속도 | UI 반응 0.5초 이내, 비동기 AI 진단 리포트 생성 5~10초 이내 완료 목표 | 🔴 |
| NFR-PERF-002 | 확장성 (Scalability) | **메시지 큐(RabbitMQ)**를 통한 부하 분산으로 대량의 AI 분석 트래픽(1,000명 동시 요청) 유연 대응 | 🔴 |
| NFR-PERF-003 | 데이터 리텐션 | OBD 로그 7일 보관 후 자동 삭제(Drop Chunk), 요약 데이터 영구 보관 | 🔴 |

### 4.2 안정성 및 보안 (NFR-SEC)

| ID | 요구사항 | 수용 기준 | 우선순위 |
|:---|:---|:---|:---:|
| NFR-SEC-001 | 데이터 암호화 | VIN, 이메일, 위치 정보 등 민감 데이터 AES-256 암호화 | 🔴 |
| NFR-SEC-002 | 통신 보안 | 전 구간 TLS 1.2+ HTTPS 적용 | 🔴 |
| NFR-SEC-003 | 기기 인증 (Binding) | OBD 어댑터와 사용자 계정/기기 간 1:1 바인딩으로 무단 접근 차단 | 🔴 |

### 4.3 신뢰성 (NFR-TRUST)

| ID | 요구사항 | 수용 기준 | 우선순위 |
|:---|:---|:---|:---:|
| NFR-TRUST-001 | AI 환각 방지 | 진단 신뢰도 점수(Confidence Score) 표시 및 "모름"에 대한 명확한 회피 반응 | 🔴 |
| NFR-TRUST-002 | Fail-Safe / Retry | 장애 또는 통신 두절 시 **메시지 큐 기반 재시도(Retry)** 전략으로 데이터 처리 무결성 보장 | 🔴 |

---

## 5. 요구사항 요약

### 5.1 우선순위 분포

| 우선순위 | 설명 | 비고 |
|:---|:---|:---|
| 🔴 **필수 (MVP)** | 핵심 진단, OBD/Cloud 수집, 고장 예측, 기본 차계부 | 1차 릴리즈 목표 |
| 🟡 **권장 (Phase 2)** | 개인화, 정탐률 고도화, 편의 기능 확장 | 안정화 후 업데이트 |
| 🟢 **로드맵 (Future)** | 예약, 견적, 자동화, 블록체인 등 고난도 확장 기능 | 장기 개발 계획 |

### 5.2 우선순위별 요구사항 집계

| 우선순위 | 개수 | 비고 |
|:---|:---:|:---|
| 🔴 **필수 (MVP)** | **48개** | 핵심 진단, OBD, 사용자, 비기능 포함 |
| 🟡 **권장 (Phase 2)** | **14개** | 편의 기능, 알림 고도화 등 |
| 🟢 **로드맵 (Future)** | **8개** | 확장 기능 및 장기 계획 |
| **총계** | **70개** | |
