# API ìƒì„¸ ëª…ì„¸ì„œ (v2.0)

> **ë¬¸ì„œ ê°œìš”**: ë³¸ ë¬¸ì„œëŠ” ì‹œìŠ¤í…œ ê°„ í†µì‹  ê·œê²©ì„ ì •ì˜í•˜ë©°, í¬ê²Œ **Client(App) â†” Backend(Java)** ì™€ **Backend(Java) â†” AI Server(Python)** ë‘ ê°€ì§€ íŒŒíŠ¸ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.
> **RabbitMQ**ëŠ” ë‚´ë¶€ ì¸í”„ë¼ í†µì‹ ìš©ì´ë¯€ë¡œ ë³¸ REST API ëª…ì„¸ì—ëŠ” í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

---

# Part 1. Frontend â†” Backend API
> **Mobile App**ê³¼ **Java Backend** ê°„ì˜ í†µì‹  ê·œê²©ì…ë‹ˆë‹¤.
> - **Base URL**: `https://api.car-sentry.com/api/v1`
> - **Global Prefix**: ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ ì•ì—ëŠ” ìë™ìœ¼ë¡œ `/api/v1`ì´ ë¶™ìŠµë‹ˆë‹¤. (ì•„ë˜ ê²½ë¡œëŠ” ì´ ì ‘ë‘ì–´ ì´í›„ì˜ ìƒëŒ€ ê²½ë¡œì…ë‹ˆë‹¤.)
> - **Auth**: `Authorization: Bearer {jwt_token}`

### ğŸ“¦ ê³µí†µ ì‘ë‹µ ê·œê²© (Common Response)
ëª¨ë“  API ì‘ë‹µì€ `ApiResponse` ê°ì²´ë¡œ ë˜í•‘ë˜ì–´ ì „ë‹¬ë©ë‹ˆë‹¤.
```json
{
  "success": true,
  "data": { ... },
  "error": null
}
```
- **success**: ìš”ì²­ ì²˜ë¦¬ ì„±ê³µ ì—¬ë¶€ (boolean)
- **data**: ì‹¤ì œ ê²°ê³¼ ë°ì´í„° (ì„±ê³µ ì‹œì—ë§Œ ì¡´ì¬, ì‹¤íŒ¨ ì‹œ null)
- **error**: ì—ëŸ¬ ì •ë³´ (ì‹¤íŒ¨ ì‹œì—ë§Œ ì¡´ì¬, ì„±ê³µ ì‹œ null)
  - `code`: ì—ëŸ¬ ì½”ë“œ
  - `message`: ìƒì„¸ ì—ëŸ¬ ë©”ì‹œì§€

## 1. ì‚¬ìš©ì ë° ì¸ì¦ (Auth & Users)
> Base Path: `/auth`

### 1.1 íšŒì›ê°€ì… (Signup)
- **POST `/auth/signup` (BE-AU-001)**
- **Request Body**:
  ```json
  {
    "email": "user@example.com",
    "password": "password123",
    "nickname": "carlover"
  }
  ```
- **Response**: `ApiResponse<UserResponse>`
  ```json
  {
    "success": true,
    "data": {
      "userId": "UUID",
      "email": "user@example.com",
      "nickname": "carlover",
      "profileImageBase64": "string (null if empty)"
    },
    "error": null
  }
  ```

### 1.2 ë¡œê·¸ì¸ ë° í† í° (Login & Token)
- **POST `/auth/login` (BE-AU-002)**: JWT í† í° ë°œê¸‰
- **Request Body**:
  ```json
  {
    "email": "user@example.com",
    "password": "password123"
  }
  ```
- **Response**: `ApiResponse<TokenResponse>`
  ```json
  {
    "success": true,
    "data": {
      "accessToken": "ey...",
      "refreshToken": "ey..."
    },
    "error": null
  }
  ```

- **POST `/auth/refresh`**: í† í° ê°±ì‹ 
- **Request Body**: `{ "refreshToken": "string" }`
- **Response**: `ApiResponse<TokenResponse>`

### 1.3 ì‚¬ìš©ì í”„ë¡œí•„ (User Profile)
- **GET `/auth/me` (BE-AU-003)**: ë‚´ í”„ë¡œí•„ ì¡°íšŒ
- **Response**: `ApiResponse<UserResponse>`

- **PATCH `/auth/me` (BE-AU-004)**: í”„ë¡œí•„ ìˆ˜ì •
- **Request Body**: `{ "nickname": "string", "memo": "string" }`

- **POST `/auth/me/image`**: í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ
- **Request**: `Multipart/form-data` íŒŒë¼ë¯¸í„° `file` (ì´ë¯¸ì§€ íŒŒì¼)

- **PATCH `/auth/fcm-token`**: FCM í† í° ì „ìš© ê°±ì‹ 
- **Request Body**: `{ "fcmToken": "string" }`

- **DELETE `/auth/me` (BE-AU-007)**: íšŒì› íƒˆí‡´ (Soft Delete)

---

## 2. ì°¨ëŸ‰ ê´€ë¦¬ (Vehicles)
> Base Path: `/vehicles`

### 2.1 ì°¨ëŸ‰ ë“±ë¡
- **POST `/vehicles` (BE-VH-001)**: ì°¨ëŸ‰ ìˆ˜ë™ ë“±ë¡
- **Request Body**:
  ```json
  {
    "manufacturer": "Hyundai",
    "modelName": "Avante",
    "modelYear": 2022,
    "fuelType": "GASOLINE",
    "totalMileage": 15000.5,
    "carNumber": "123ê°€4567",
    "nickname": "My Car (Optional)",
    "memo": "Daily drive (Optional)",
    "obdDeviceId": "OBD-XYZ-001 (Optional)",
    "consumables": [
      {
        "code": "ENGINE_OIL",
        "lastReplacedAt": "2024-01-01T00:00:00",
        "lastReplacedMileage": 10000.0
      }
    ]
  }
  ```
- **Note**: `consumables` ë¦¬ìŠ¤íŠ¸ëŠ” ì„ íƒ ì‚¬í•­ì…ë‹ˆë‹¤. ì…ë ¥í•˜ì§€ ì•Šì€ ì†Œëª¨í’ˆ(9ì¢… ì „ì²´ ëŒ€ìƒ)ì€ ì‹œìŠ¤í…œ í‘œì¤€ ì£¼ê¸°ì— ë”°ë¼ ìë™ìœ¼ë¡œ ìƒíƒœê°€ ì¶”ë¡ ë˜ì–´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.
- **Response**: `ApiResponse<VehicleDto.Response>`
  ```json
  {
    "success": true,
    "data": {
      "vehicleId": "UUID",
      "userId": "UUID",
      "manufacturer": "Hyundai",
      "modelName": "Avante",
      "modelYear": 2022,
      "fuelType": "GASOLINE",
      "totalMileage": 15000.5,
      "carNumber": "123ê°€4567",
      "nickname": "My Car",
      "memo": "Daily drive",
      "isPrimary": false,
      "registrationSource": "MANUAL",
      "obdDeviceId": "OBD-XYZ-001"
    },
    "error": null
  }
  ```

- **POST `/vehicles/obd` (BE-VH-002)**: OBD ê¸°ë°˜ ì°¨ëŸ‰ ìë™ ë“±ë¡ (VIN ìë™ ë§¤í•‘)
- **Request Body**: `{ "vin": "17_CHAR_VIN_CODE" }`
- **Response**: `ApiResponse<VehicleDto.Response>`

### 2.2 ì°¨ëŸ‰ ì¡°íšŒ ë° ìˆ˜ì •
- **GET `/vehicles` (BE-VH-004)**: ë³´ìœ  ì°¨ëŸ‰ ëª©ë¡ ì¡°íšŒ
- **Response**: `ApiResponse<List<VehicleDto.Response>>`

- **GET `/vehicles/{id}` (BE-VH-004)**: ì°¨ëŸ‰ ìƒì„¸ ì •ë³´ ì¡°íšŒ
- **Response**: `ApiResponse<VehicleDto.Response>`

- **PUT `/vehicles/{id}` (BE-VH-004)**: ì°¨ëŸ‰ ì •ë³´ ìˆ˜ì • (ë³„ëª…, ë©”ëª¨)
- **Request Body**: `{ "nickname": "string", "memo": "string" }`

- **PATCH `/vehicles/primary` (BE-VH-006)**: ëŒ€í‘œ ì°¨ëŸ‰ ì„¤ì •
- **Request Body**: `{ "vehicleId": "UUID" }`

- **DELETE `/vehicles/{id}` (BE-VH-007)**: ì°¨ëŸ‰ ì‚­ì œ (Soft Delete)

### 2.3 ë§ˆìŠ¤í„° ë°ì´í„° (Master Data)
> Base Path: `/master`

- **GET `/master/manufacturers` (BE-VH-003)**: ì œì¡°ì‚¬ ëª©ë¡ ì¡°íšŒ (ì˜ˆ: Hyundai, Kia)
- **Response**: `ApiResponse<List<String>>`

- **GET `/master/models` (BE-VH-003)**: ëª¨ë¸ ëª©ë¡ ì¡°íšŒ (íŒŒë¼ë¯¸í„°: manufacturer)
- **Response**: `ApiResponse<List<CarModelDto>>`

---

## 3. ì •ë¹„ ë° ì†Œëª¨í’ˆ (Maintenance)
> Base Path: `/vehicles`

### 3.1 ì •ë¹„ ì´ë ¥ ê´€ë¦¬
- **POST `/vehicles/{vehicleId}/maintenance` (BE-MT-001)**: ì •ë¹„ ê¸°ë¡ ë“±ë¡ (ë‹¤ì¤‘ ë“±ë¡ ì§€ì›)
- **Request Body**: `List<MaintenanceHistoryRequest>`
  ```json
  [
    {
      "maintenanceDate": "2024-01-17",
      "mileageAtMaintenance": 15500.0,
      "consumableItemId": 1,
      "isStandardized": true,
      "shopName": "Service Center",
      "cost": 85000,
      "ocrData": "string (Optional)",
      "memo": "First oil change"
    }
  ]
  ```
- **Response**: `ApiResponse<List<MaintenanceHistoryResponse>>`

- **GET `/vehicles/{vehicleId}/maintenance`**: ì°¨ëŸ‰ë³„ ì •ë¹„ ì´ë ¥ ëª©ë¡ ì¡°íšŒ (ìµœê·¼ìˆœ)
- **Response**: `ApiResponse<List<MaintenanceHistoryResponse>>`

- **POST `/vehicles/maintenance/ocr` (BE-MT-003)**: ì •ë¹„ ì˜ìˆ˜ì¦ ë¶„ì„ (OCR)
- **Request**: `Multipart/form-data` íŒŒë¼ë¯¸í„° `file` (ì˜ìˆ˜ì¦ ì´ë¯¸ì§€)
- **Response**: `ApiResponse<MaintenanceReceiptResponse>`

- **GET `/vehicles/{vehicleId}/consumables`**: ì£¼ìš” ì†Œëª¨í’ˆ ìƒíƒœ ë° ìˆ˜ëª… ì˜ˆì¸¡ ì¡°íšŒ
- **Response**: `ApiResponse<List<ConsumableStatusResponse>>`
  ```json
  {
    "success": true,
    "data": [
      {
        "item": "ENGINE_OIL",
        "itemDescription": "ì—”ì§„ ì˜¤ì¼",
        "remainingLifePercent": 85.5,
        "lastMaintenanceDate": "2024-01-17",
        "lastMaintenanceMileage": 15500.0,
        "replacementIntervalMileage": 10000.0,
        "replacementIntervalMonths": 12,
        "predictedReplacementDate": "2025-01-17"
      }
    ]
  }
  ```

---

## 4. í…”ë ˆë©”íŠ¸ë¦¬ ë° ìš´ì „ ë¶„ì„ (Telemetry)
> Base Path: `/telemetry`

### 4.1 OBD ë°ì´í„° ìˆ˜ì§‘
- **POST `/telemetry/batch` (BE-TD-002)**: OBD ë¡œê·¸ ë°°ì¹˜ ì—…ë¡œë“œ (3ë¶„ ì£¼ê¸°)
- **Request Body**: `List<ObdLogDto>` (timestamp, vehicleId, rpm, speed ë“± í¬í•¨)
- **Response**: `ApiResponse<Void>`

- **GET `/telemetry/status/{vehicleId}` (BE-TD-006)**: ì°¨ëŸ‰ ì‹¤ì‹œê°„ ì—°ê²° ìƒíƒœ ì¡°íšŒ
- **Response**: `ApiResponse<ConnectionStatusDto>` (`connected`, `lastDataTime`, `statusMessage`)

- **POST `/telemetry/status/disconnect`**: ì°¨ëŸ‰ ìˆ˜ë™ ì—°ê²° í•´ì œ (ì„¸ì…˜ ê°•ì œ ì¢…ë£Œ)
- **Request Body**: `{ "vehicleId": "UUID" }`

---

## 5. ì£¼í–‰ ì„¸ì…˜ ê´€ë¦¬ (Trips)
> Base Path: `/trips`

### 5.1 ì£¼í–‰ ì‹œì‘ ë° ì¢…ë£Œ
- **POST `/trips/start` (BE-TD-001)**: ì£¼í–‰ ì„¸ì…˜ ì‹œì‘
- **Request Body**: `{ "vehicleId": "UUID" }`
- **Response**: `ApiResponse<TripSummary>`

- **POST `/trips/end` (BE-TD-004)**: ì£¼í–‰ ì„¸ì…˜ ì¢…ë£Œ ë° ìš”ì•½ ì €ì¥
- **Request Body**: `{ "tripId": "UUID" }`
- **Response**: `ApiResponse<TripSummary>`
  ```json
  {
    "success": true,
    "data": {
      "tripId": "UUID",
      "vehicleId": "UUID",
      "startTime": "2024-01-17T14:30:00",
      "endTime": "2024-01-17T15:00:00",
      "distance": 15.5,
      "driveScore": 95,
      "averageSpeed": 45.0,
      "topSpeed": 85.0
    }
  }
  ```

- **GET `/trips` (BE-TD-005)**: ë‚´ ì£¼í–‰ ì´ë ¥ ëª©ë¡ ì¡°íšŒ (íŒŒë¼ë¯¸í„°: vehicleId)
- **Note**: 100m ë¯¸ë§Œì˜ ì§§ì€ ì£¼í–‰ì€ ëª©ë¡ì—ì„œ ì œì™¸ë©ë‹ˆë‹¤.
- **Response**: `ApiResponse<List<TripSummary>>`

---

## 6. AI ì§„ë‹¨ ë° ë¦¬í¬íŠ¸ (AI Diagnosis)
> Base Path: `/ai`

### 6.1 í†µí•© ì§„ë‹¨ ìš”ì²­
- **POST `/ai/diagnose/unified`**: ë©€í‹°ëª¨ë‹¬ í†µí•© ì§„ë‹¨ ìš”ì²­ (Multipart)
- **Request (Multipart)**:
  - `request`: `UnifiedDiagnosisRequestDto` (JSON String)
  - `audioFile`: ì˜¤ë””ì˜¤ íŒŒì¼ (Optional)
  - `visionFile`: ì´ë¯¸ì§€ íŒŒì¼ (Optional)
- **Response**: `ApiResponse<DiagnosisResponseDto>`

- **POST `/ai/diagnose` (BE-AI-001)**: ì¼ë°˜ ì§„ë‹¨ ìš”ì²­ (DTC, Anomaly ë“±)
- **Request Body**: `DiagnosisRequestDto` (vehicleId, type, mediaUrl ë“±)
- **Response**: `ApiResponse<DiagnosisResponseDto>`

- **GET `/ai/diagnose/{session_id}` (BE-AI-005) [êµ¬í˜„ ì˜ˆì •]**: ì§„ë‹¨ ê²°ê³¼ ìƒì„¸ ì¡°íšŒ
- **GET `/ai/missions/{session_id}` (BE-AI-006) [êµ¬í˜„ ì˜ˆì •]**: ì¶”ê°€ ì¦ê±° ìš”ì²­ ë¯¸ì…˜ í™•ì¸

### 6.2 ë¯¸ë””ì–´ ì—…ë¡œë“œ
- **POST `/ai/media/upload`**: ì§„ë‹¨ìš© ë¯¸ë””ì–´ íŒŒì¼ ì—…ë¡œë“œ (S3/Local)
- **Request**: `Multipart/form-data` (file)
- **Response**: `ApiResponse<Map<String, String>>` (`{ "url": "..." }`)

### 6.3 ì§€ì‹ ë² ì´ìŠ¤ ê²€ìƒ‰ (RAG)
- **GET `/ai/knowledge/search` (BE-AI-005)**: ìë™ì°¨ ìê°€ì§„ë‹¨ ë° ì§€ì‹ Q&A
- **Query**: `query` (ì§ˆë¬¸ ë¬¸ìì—´)
- **Response**: `ApiResponse<List<KnowledgeBaseResponse>>`

---

## 7. ë¶€ê°€ ê¸°ëŠ¥ ë° ì•Œë¦¼ (Features & Notifications)
> Base Path: (ê³µí†µ)

- **GET `/notifications` (BE-NT-001)**: ì•Œë¦¼ ì„¼í„° ë‚´ì—­ ì¡°íšŒ
- **Response**: `ApiResponse<List<Notification>>`

- **PATCH `/notifications/{id}/read`**: ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬
- **Response**: `ApiResponse<String>`

- **GET `/insights/personal` (BE-TD-008) [êµ¬í˜„ ì˜ˆì •]**: ê°œì¸í™” ìš´ì „/ì •ë¹„ ì¸ì‚¬ì´íŠ¸ ì¡°íšŒ
- **GET `/vehicles/{id}/anomalies` (BE-TD-006) [êµ¬í˜„ ì˜ˆì •]**: ì´ìƒ ì§•í›„ ê°ì§€ ì´ë ¥ ì¡°íšŒ

---

## 8. ì–´ë“œë¯¼ ë° í…ŒìŠ¤íŠ¸ (Admin & Test)
> Base Path: `/admin`, `/ai/test`

- **GET `/admin/users`**: ì „ì²´ ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ (ê´€ë¦¬ììš©)
- **GET `/admin/vehicles`**: ì „ì²´ ë“±ë¡ ì°¨ëŸ‰ ëª©ë¡ ì¡°íšŒ

- **GET `/ai/test/knowledge/search`**: RAG ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ (ì„ë² ë”© ë° ë²¡í„° ê²€ìƒ‰ ê²€ì¦ìš©)
- **POST `/ai/test/dtc/report`**: DTC ë°œìƒ ê°•ì œ ë¦¬í¬íŠ¸ í…ŒìŠ¤íŠ¸
# Part 2. Backend â†” AI Server API
> **Java Backend**ê°€ **Python AI Server**ë¡œ ì¶”ë¡ ì„ ìš”ì²­í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë‚´ë¶€ APIì…ë‹ˆë‹¤.
> - **Base URL**: `http://host.docker.internal:8001/api/v1/connect`
> - **Protocol**: HTTP/1.1 (Wait for Response)

### 1. Vision Analysis (YOLOv8)
- **POST `/predict/visual`**
    - **Description**: ì°¨ëŸ‰ ì™¸ê´€ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ì—¬ ì†ìƒ ë¶€ìœ„ íƒì§€.
    - **Request (Multipart)**:
        - `file`: ì´ë¯¸ì§€ íŒŒì¼ (Binary)
    - **Response (JSON)**:
        ```json
        {
            "status": "DAMAGED",
            "damage_area_px": 4500,
            "detections": [
                {
                    "label": "SCRATCH",
                    "confidence": 0.92,
                    "bbox": [120, 45, 200, 150] // [x, y, w, h]
                }
            ],
            "processed_image_url": "s3://..."
        }
        ```

### 2. Audio Diagnosis (AST)
- **POST `/predict/audio`**
    - **Description**: ì—”ì§„/ë¶€í’ˆ ì†Œë¦¬ë¥¼ ë¶„ì„í•˜ì—¬ ì´ìƒ ìœ ë¬´ ë° ì›ì¸ íŒë³„.
    - **Request (Multipart)**:
        - `file`: ì˜¤ë””ì˜¤ íŒŒì¼ (.wav, .m4a)
    - **Response (JSON)**:
        ```json
        {
            "primary_status": "FAULTY",
            "component": "ENGINE_BELT",
            "detail": {
                "diagnosed_label": "SLIP_NOISE",
                "description": "êµ¬ë™ ë²¨íŠ¸ ì¥ë ¥ ë¶€ì¡± ì˜ì‹¬"
            },
            "confidence": 0.88,
            "is_critical": false
        }
        ```

### 3. Anomaly Detection (LSTM-AE)
- **POST `/predict/anomaly`**
    - **Description**: ìµœê·¼ 60ì´ˆê°„ì˜ ê³µê³µ OBD ì‹œê³„ì—´ ë°ì´í„°ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ LSTM-AutoEncoder ê¸°ë°˜ìœ¼ë¡œ ì£¼í–‰ ìƒíƒœì˜ ì´ìƒ ì—¬ë¶€ë¥¼ íŒë‹¨í•©ë‹ˆë‹¤.
    - **Request (JSON)**:
        ```json
        {
          "vehicle_id": "UUID-or-string",
          "duration_sec": 60,
          "sampling_hz": 10,
          "timestamp_unit": "s",
          "data": [
            {
              "t": 0,
              "features": {
                "engine_coolant_temp_c": 86.2,
                "imap_kpa": 41.8,
                "engine_rpm": 2100,
                "vehicle_speed_kmh": 32.1,
                "intake_air_temp_c": 29.0,
                "maf_gps": 12.7,
                "throttle_pos_pct": 18.0,
                "ambient_air_temp_c": 27.0,
                "acc_pedal_pos_d_pct": 14.0,
                "acc_pedal_pos_e_pct": 14.0
              }
            }
          ],
          "options": {
            "top_signals": "on_anomaly",
            "top_k": 3
          }
        }
        ```
    - **Response (JSON)**:
        ```json
        {
          "score": 0.85,
          "threshold": 0.70,
          "is_anomaly": true,
          "top_signals": [
            { "feature": "engine_rpm", "contribution": 0.31 },
            { "feature": "imap_kpa", "contribution": 0.22 },
            { "feature": "throttle_pos_pct", "contribution": 0.12 }
          ]"contributing_factors": ["RPM", "VOLTAGE"]
        }
        ```

### 4. Wear Factor Prediction (XGBoost)
- **POST `/predict/wear-factor`**
    - **Description**: ì°¨ëŸ‰ ëˆ„ì  ë°ì´í„° ë° ìš´ì „ ìŠµê´€ì„ ê¸°ë°˜ìœ¼ë¡œ ì†Œëª¨í’ˆ ë…¸í™” ê³„ìˆ˜ ì˜ˆì¸¡.
    - **Request (JSON)**:
        ```json
        {
            "target_item": "ENGINE_OIL", // [Add] ì˜ˆì¸¡ ëŒ€ìƒ (ENGINE_OIL, BRAKE_PADS, TIRES ë“±)
            "last_replaced": {           // [Add] ë§ˆì§€ë§‰ êµì²´ ì‹œì 
                "date": "2025-06-01",
                "mileage": 48000         // [Check] êµì²´ ë‹¹ì‹œ ì´ ì£¼í–‰ê±°ë¦¬ (ëˆ„ì ê°’) -> í˜„ì¬-ì´ê±° = ì‚¬ìš©ëŸ‰
            },
            "vehicle_metadata": {
                "model_year": 2020,
                "fuel_type": "GASOLINE",
                "total_mileage": 52000
            },
            "driving_habits": {
                "avg_rpm": 2200,
                "hard_accel_count": 15,
                "hard_brake_count": 8,
                "idle_ratio": 0.15
            }
        }
        ```
    - **Response (JSON)**:
        ```json
        {
            "predicted_wear_factor": 1.15, // í‘œì¤€ ëŒ€ë¹„ 1.15ë°° ë¹ ë¥´ê²Œ ë§ˆëª¨ ì¤‘
            "model_version": "v1.0.2"
        }
        ```

### 5. Text Embedding (Ollama)
- **POST `/embedding`**
    - **Description**: í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥ë°›ì•„ ë²¡í„°(ì„ë² ë”©)ë¥¼ ë°˜í™˜ (RAG ê²€ìƒ‰ìš©).
    - **Request (JSON)**:
        ```json
        {
            "text": "ì—”ì§„ ì˜¤ì¼ êµì²´ ì£¼ê¸°"
        }
        ```
    - **Response (JSON)**:
        ```json
        {
            "embedding": [0.123, -0.456, ...], // 1024 dimensions
        }
        ```

### 6. AI ì§„ë‹¨ í†µí•© (LLM Generation)
- **POST `/generate/diagnosis`**
    - **Description**: ìˆ˜ì§‘ëœ ëª¨ë“  ë©€í‹°ëª¨ë‹¬ ë°ì´í„°ì™€ RAG ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì¢…í•©í•˜ì—¬, LLM ê¸°ë°˜ì˜ ìµœì¢… ì§„ë‹¨ ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    - **Request (JSON)**:
        ```json
        {
            "diagnosis_context": {
                "overall_confidence": 0.85,  // ì‹œìŠ¤í…œ ê³„ì‚° ì¢…í•© ì‹ ë¢°ë„ (0.0~1.0)
                "data_sources": ["OBD", "SOUND", "MANUAL"],
                "is_confirmed_source": true  // OBD/DTC ë“± í™•ì • ë°ì´í„° í¬í•¨ ì—¬ë¶€
            },
            "vehicle_info": {
                "model": "Avante",
                "year": 2012,
                "fuel_type": "GASOLINE",
                "mileage": 150000
            },
            "consumables_status": [ // ì†Œëª¨í’ˆ ìˆ˜ëª… ì˜ˆì¸¡ ê²°ê³¼ ë° ê°€ì¤‘ì¹˜
                {
                    "item": "ENGINE_OIL",
                    "remaining_life": 0.45, // 45% ë‚¨ìŒ
                    "wear_factor": 1.2      // ê°€í˜¹ ì£¼í–‰ìœ¼ë¡œ 1.2ë°° ë¹ ë¥´ê²Œ ì†Œëª¨ ì¤‘
                }
            ],
            "analysis_results": { // ê°œë³„ ëª¨ë¸ ë¶„ì„ ê²°ê³¼ë“¤
                "sound": {
                    "detected": true,
                    "label": "Belt Slip",
                    "confidence": 0.8
                },
                "image": {
                    "detected": false
                },
                "lstm": {
                    "is_anomaly": true,
                    "anomaly_score": 0.9,
                    "factors": ["RPM"]
                }
            },
            "rag_context": [ // RAG ê²€ìƒ‰ ê²°ê³¼ (2010~2013 ë§¤ë‰´ì–¼)
                "ëƒ‰ê°ìˆ˜ ì˜¨ë„ê°€ 110ë„ ì´ìƒì¼ ê²½ìš° ê³¼ì—´ë¡œ ê°„ì£¼í•˜ë©°...",
                "(ì£¼ì˜: ë³¸ ë§¤ë‰´ì–¼ ì •ë³´ëŠ” 2010~2013ë…„ì‹ ê¸°ì¤€ì„)"
            ]
        }
        ```
    - **Response (JSON)**:
        ```json
        {
            "response_mode": "REPORT", // REPORT | INTERACTIVE
            "confidence_level": "HIGH",
            "summary": "ëƒ‰ê°ìˆ˜ ê³¼ì—´ì´ ê°ì§€ë©ë‹ˆë‹¤.",
            "report_data": {
                "suspected_causes": [
                    {
                        "cause": "ëƒ‰ê°ìˆ˜ ê³¼ì—´ (Overheating)",
                        "basis": "OBD ìˆ˜ì˜¨ 115ë„ ë° LSTM ì´ìƒ ê°ì§€",
                        "source_type": "CONFIRMED",
                        "reliability": "HIGH"
                    }
                ],
                "final_guide": "ì¦‰ì‹œ ì •ì°¨ í›„ ëƒ‰ê°ìˆ˜ ë ˆë²¨ì„ ì ê²€í•´ ì£¼ì„¸ìš”."
            },
            "interactive_data": null, // REPORT ëª¨ë“œì¼ ë• null
            "disclaimer": "ë³¸ ì§„ë‹¨ì€ 2010~2013ë…„ì‹ ë§¤ë‰´ì–¼ ë° AI ì¶”ë¡ ì— ê¸°ë°˜í•©ë‹ˆë‹¤."
        }
        ```
        *(ë§Œì•½ ë°ì´í„° ë¶€ì¡±ìœ¼ë¡œ **INTERACTIVE** ëª¨ë“œì¼ ê²½ìš° ì˜ˆì‹œ)*:
        ```json
        {
            "response_mode": "INTERACTIVE",
            "confidence_level": "LOW",
            "summary": "íŒë‹¨ ê²°ê³¼ê°€ ìƒì¶©ë˜ì–´ ì¶”ê°€ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.",
            "report_data": null,
            "interactive_data": {
                "message": "ì„¼ì„œ ë°ì´í„°ëŠ” ì •ìƒì´ì§€ë§Œ ì†ŒìŒì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ë” ì •í™•í•œ ë¶„ì„ì„ ìœ„í•´ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.",
                "follow_up_questions": [
                    "ì‹œë™ì„ ëˆ ìƒíƒœì—ì„œë„ ì†Œë¦¬ê°€ ê³„ì† ë‚˜ë‚˜ìš”?",
                    "ìµœê·¼ì— ì—”ì§„ ì˜¤ì¼ì„ ì–¸ì œ êµì²´í•˜ì…¨ë‚˜ìš”?"
                ],
                "requested_actions": ["CAPTURE_PHOTO"]
            },
            "disclaimer": "ë³¸ ì§„ë‹¨ì€ íŒ©íŠ¸ê°€ ì•„ë‹Œ ì¶”ë¡  ê¸°ë°˜ì´ë¯€ë¡œ ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤."
        }
        ```
