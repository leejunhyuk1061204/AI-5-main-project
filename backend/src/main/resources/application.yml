spring:
  application:
    name: backend
  jackson:
    time-zone: Asia/Seoul

  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:car_sentry}
    username: ${DB_USER:postgres}
    password: ${DB_PASSWORD:postgres}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        format_sql: true

  batch:
    jdbc:
      initialize-schema: always # Batch 테이블 자동 생성
    job:
      enabled: false # 시작 시 모든 Job 실행 방지

  cloud:
    aws:
      region:
        static: ap-northeast-2
      credentials:
        access-key: ${AWS_ACCESS_KEY_ID:dummy}
        secret-key: ${AWS_SECRET_ACCESS_KEY:dummy}
      s3:
        enabled: true
      stack:
        auto: false

  rabbitmq:
    host: ${MQ_HOST:localhost}
    port: ${MQ_PORT:5672}
    username: ${MQ_USER:guest}
    password: ${MQ_PASSWORD:guest}
    listener:
      simple:
        concurrency: 2
        max-concurrency: 5
        retry:
          enabled: true
          initial-interval: 5000ms
          max-attempts: 3
          multiplier: 2.0



app:
  storage:
    type: ${STORAGE_TYPE:local} # local or s3
  firebase:
    config-path: ${FIREBASE_CONFIG_PATH:firebase-service-account.json}

# AI 설정은 Java AiClient 클래스의 @Value 기본값을 사용하지만, 
# Docker 환경을 고려하여 기본 호스트를 host.docker.internal로 명시적 설정
ai:
  server:
    url:
      visual: ${AI_SERVER_URL_VISUAL:http://host.docker.internal:8001/api/v1/connect/predict/visual}
      audio: ${AI_SERVER_URL_AUDIO:http://host.docker.internal:8001/api/v1/connect/predict/audio}
      comprehensive: ${AI_SERVER_URL_COMPREHENSIVE:http://host.docker.internal:8001/api/v1/connect/predict/comprehensive}
      anomaly: ${AI_SERVER_URL_ANOMALY:http://host.docker.internal:8001/api/v1/connect/predict/anomaly}
      wear-factor: ${AI_SERVER_URL_WEAR_FACTOR:http://host.docker.internal:8001/api/v1/connect/predict/wear-factor}

logging:
  level:
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
    org.springframework.web: DEBUG # 404 디버깅용 로그 추가

encryption:
  key: ${ENCRYPTION_KEY:car-sentry-default-key-32bytes-!!} # 32바이트 권장

jwt:
  secret: ${JWT_SECRET:vmb70atp-bd59-400a-9450-523a253d0a90-this-is-a-long-secret-key-for-development}
  access-expiration: 3600000 # 1시간으로 원복
  refresh-expiration: 604800000 # 7일

smartcar:
  client-id: ${SMARTCAR_CLIENT_ID:7a114bab-4496-481e-97d6-665f464f8396}
  client-secret: ${SMARTCAR_CLIENT_SECRET:your-smartcar-secret-here}
  redirect-uri: ${SMARTCAR_REDIRECT_URI:http://localhost:8080/api/v1/auth/callback/smartcar}
  token-uri: https://auth.smartcar.com/oauth/token

high-mobility:
  client-id: ${HM_CLIENT_ID:3c26eb5b-3af5-48b9-b8e3-1bff90976dce}
  client-secret: ${HM_CLIENT_SECRET:taDQDeBOG3TEaZqSfQKQ--lg9OjQIgdK}
  redirect-uri: ${HM_REDIRECT_URI:http://localhost:8080/api/v1/auth/callback/high_mobility}
  token-uri: https://sandbox.api.high-mobility.com/v1/access_tokens


